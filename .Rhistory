#Task: Get Census data for income and race, format data
#Related files:
library(foreign)
library(effects)
library(sciplot)
library(sandwich)
library(lmtest)
library(BMS)
library(rJava)
library(lattice)
library(plyr)
library(lme4)
library(gmodels)
library(MASS)
library(stringr)
library("XLConnect")
library(reshape2)
library(xlsx)
library(dplyr)
library(doBy)
library(Hmisc)
library(stargazer)
library(xtable)
library(dplyr)
library(xtable)
library(foreign)
library(dotwhisker)#https://cran.r-project.org/web/packages/dotwhisker/vignettes/dotwhisker-vignette.html
library(berryFunctions) #for the insert row function
library(ggplot2)
library(gridExtra)
library(wnominate)
library(tidyr)
library(wnominate)
library(oc)
library(haven)
library(tidycensus)
library(ggplot2)
library(tidyverse)
library(viridis)
#census_api_key("675a9f1c7c48099a105107acfb31feaa5b78331f", install=TRUE)
income.11 <- get_acs(geography = "congressional district", variables = "B19013_001",
geometry = TRUE, year = 2011, survey="acs1", cache_table = TRUE)
income.12 <- get_acs(geography = "congressional district", variables = "B19013_001",
geometry = TRUE, year = 2012, survey="acs1", cache_table = TRUE)
income.13 <- get_acs(geography = "congressional district", variables = "B19013_001",
geometry = TRUE, year = 2013, survey="acs1", cache_table = TRUE)
#14 is not working for some reason
v14<-load_variables(2014, "acs1", cache = TRUE)
#income.14 <- get_acs(geography = "congressional district", variables = "B19013_001",
#                    geometry = TRUE, year = 2014, survey="acs1", cache_table = TRUE)
income.15 <- get_acs(geography = "congressional district", variables = "B19013_001",
geometry = TRUE, year = 2015, survey="acs1", cache_table = TRUE)
income.16 <- get_acs(geography = "congressional district", variables = "B19013_001",
geometry = TRUE, year = 2016, survey="acs1", cache_table = TRUE)
income.17 <- get_acs(geography = "congressional district", variables = "B19013_001",
geometry = TRUE, year = 2017, survey="acs1", cache_table = TRUE)
income.18 <- get_acs(geography = "congressional district", variables = "B19013_001",
geometry = TRUE, year = 2018, survey="acs1", cache_table = TRUE)
income.19 <- get_acs(geography = "congressional district", variables = "B19013_001",
geometry = TRUE, year = 2019, survey="acs1", cache_table = TRUE)
#find quintile variables
v17<-load_variables(2017, "acs1", cache = TRUE)
#income quintiles
quartile.19.1 <- get_acs(geography = "congressional district", variables = "B19081_001",
geometry = TRUE, year = 2019, survey="acs1", cache_table = TRUE)
quartile.19.2 <- get_acs(geography = "congressional district", variables = "B19081_002",
geometry = TRUE, year = 2019, survey="acs1", cache_table = TRUE)
quartile.19.3 <- get_acs(geography = "congressional district", variables = "B19081_003",
geometry = TRUE, year = 2019, survey="acs1", cache_table = TRUE)
quartile.19.4 <- get_acs(geography = "congressional district", variables = "B19081_004",
geometry = TRUE, year = 2019, survey="acs1", cache_table = TRUE)
quartile.19.5 <- get_acs(geography = "congressional district", variables = "B19081_005",
geometry = TRUE, year = 2019, survey="acs1", cache_table = TRUE)
quartile.19.top5 <- get_acs(geography = "congressional district", variables = "B19081_006",
geometry = TRUE, year = 2019, survey="acs1", cache_table = TRUE)
####
quartile.18.1 <- get_acs(geography = "congressional district", variables = "B19081_001",
geometry = TRUE, year = 2018, survey="acs1", cache_table = TRUE)
quartile.18.2 <- get_acs(geography = "congressional district", variables = "B19081_002",
geometry = TRUE, year = 2018, survey="acs1", cache_table = TRUE)
quartile.18.3 <- get_acs(geography = "congressional district", variables = "B19081_003",
geometry = TRUE, year = 2018, survey="acs1", cache_table = TRUE)
quartile.18.4 <- get_acs(geography = "congressional district", variables = "B19081_004",
geometry = TRUE, year = 2018, survey="acs1", cache_table = TRUE)
quartile.18.5 <- get_acs(geography = "congressional district", variables = "B19081_005",
geometry = TRUE, year = 2018, survey="acs1", cache_table = TRUE)
quartile.18.top5 <- get_acs(geography = "congressional district", variables = "B19081_006",
geometry = TRUE, year = 2018, survey="acs1", cache_table = TRUE)
quartile.17.1 <- get_acs(geography = "congressional district", variables = "B19081_001",
geometry = TRUE, year = 2017, survey="acs1", cache_table = TRUE)
quartile.17.2 <- get_acs(geography = "congressional district", variables = "B19081_002",
geometry = TRUE, year = 2017, survey="acs1", cache_table = TRUE)
quartile.17.3 <- get_acs(geography = "congressional district", variables = "B19081_003",
geometry = TRUE, year = 2017, survey="acs1", cache_table = TRUE)
quartile.17.4 <- get_acs(geography = "congressional district", variables = "B19081_004",
geometry = TRUE, year = 2017, survey="acs1", cache_table = TRUE)
quartile.17.5 <- get_acs(geography = "congressional district", variables = "B19081_005",
geometry = TRUE, year = 2017, survey="acs1", cache_table = TRUE)
quartile.17.top5 <- get_acs(geography = "congressional district", variables = "B19081_006",
geometry = TRUE, year = 2017, survey="acs1", cache_table = TRUE)
quartile.16.1 <- get_acs(geography = "congressional district", variables = "B19081_001",
geometry = TRUE, year = 2016, survey="acs1", cache_table = TRUE)
quartile.16.2 <- get_acs(geography = "congressional district", variables = "B19081_002",
geometry = TRUE, year = 2016, survey="acs1", cache_table = TRUE)
quartile.16.3 <- get_acs(geography = "congressional district", variables = "B19081_003",
geometry = TRUE, year = 2016, survey="acs1", cache_table = TRUE)
quartile.16.4 <- get_acs(geography = "congressional district", variables = "B19081_004",
geometry = TRUE, year = 2016, survey="acs1", cache_table = TRUE)
quartile.16.5 <- get_acs(geography = "congressional district", variables = "B19081_005",
geometry = TRUE, year = 2016, survey="acs1", cache_table = TRUE)
quartile.16.top5 <- get_acs(geography = "congressional district", variables = "B19081_006",
geometry = TRUE, year = 2016, survey="acs1", cache_table = TRUE)
quartile.15.1 <- get_acs(geography = "congressional district", variables = "B19081_001",
geometry = TRUE, year = 2015, survey="acs1", cache_table = TRUE)
quartile.15.2 <- get_acs(geography = "congressional district", variables = "B19081_002",
geometry = TRUE, year = 2015, survey="acs1", cache_table = TRUE)
quartile.15.3 <- get_acs(geography = "congressional district", variables = "B19081_003",
geometry = TRUE, year = 2015, survey="acs1", cache_table = TRUE)
quartile.15.4 <- get_acs(geography = "congressional district", variables = "B19081_004",
geometry = TRUE, year = 2015, survey="acs1", cache_table = TRUE)
quartile.15.5 <- get_acs(geography = "congressional district", variables = "B19081_005",
geometry = TRUE, year = 2015, survey="acs1", cache_table = TRUE)
quartile.15.top5 <- get_acs(geography = "congressional district", variables = "B19081_006",
geometry = TRUE, year = 2015, survey="acs1", cache_table = TRUE)
# quartile.14.1 <- get_acs(geography = "congressional district", variables = "B19081_001",
#                          geometry = TRUE, year = 2014, survey="acs1", cache_table = TRUE)
#
# quartile.14.2 <- get_acs(geography = "congressional district", variables = "B19081_002",
#                          geometry = TRUE, year = 2014, survey="acs1", cache_table = TRUE)
#
# quartile.14.3 <- get_acs(geography = "congressional district", variables = "B19081_003",
#                          geometry = TRUE, year = 2014, survey="acs1", cache_table = TRUE)
#
# quartile.14.4 <- get_acs(geography = "congressional district", variables = "B19081_004",
#                          geometry = TRUE, year = 2014, survey="acs1", cache_table = TRUE)
#
# quartile.14.5 <- get_acs(geography = "congressional district", variables = "B19081_005",
#                          geometry = TRUE, year = 2014, survey="acs1", cache_table = TRUE)
#
# quartile.14.top5 <- get_acs(geography = "congressional district", variables = "B19081_006",
#                             geometry = TRUE, year = 2014, survey="acs1", cache_table = TRUE)
quartile.13.1 <- get_acs(geography = "congressional district", variables = "B19081_001",
geometry = TRUE, year = 2013, survey="acs1", cache_table = TRUE)
quartile.13.2 <- get_acs(geography = "congressional district", variables = "B19081_002",
geometry = TRUE, year = 2013, survey="acs1", cache_table = TRUE)
quartile.13.3 <- get_acs(geography = "congressional district", variables = "B19081_003",
geometry = TRUE, year = 2013, survey="acs1", cache_table = TRUE)
quartile.13.4 <- get_acs(geography = "congressional district", variables = "B19081_004",
geometry = TRUE, year = 2013, survey="acs1", cache_table = TRUE)
quartile.13.5 <- get_acs(geography = "congressional district", variables = "B19081_005",
geometry = TRUE, year = 2013, survey="acs1", cache_table = TRUE)
quartile.13.top5 <- get_acs(geography = "congressional district", variables = "B19081_006",
geometry = TRUE, year = 2013, survey="acs1", cache_table = TRUE)
quartile.12.1 <- get_acs(geography = "congressional district", variables = "B19081_001",
geometry = TRUE, year = 2012, survey="acs1", cache_table = TRUE)
quartile.12.2 <- get_acs(geography = "congressional district", variables = "B19081_002",
geometry = TRUE, year = 2012, survey="acs1", cache_table = TRUE)
quartile.12.3 <- get_acs(geography = "congressional district", variables = "B19081_003",
geometry = TRUE, year = 2012, survey="acs1", cache_table = TRUE)
quartile.12.4 <- get_acs(geography = "congressional district", variables = "B19081_004",
geometry = TRUE, year = 2012, survey="acs1", cache_table = TRUE)
quartile.12.5 <- get_acs(geography = "congressional district", variables = "B19081_005",
geometry = TRUE, year = 2012, survey="acs1", cache_table = TRUE)
quartile.12.top5 <- get_acs(geography = "congressional district", variables = "B19081_006",
geometry = TRUE, year = 2012, survey="acs1", cache_table = TRUE)
quartile.11.1 <- get_acs(geography = "congressional district", variables = "B19081_001",
geometry = TRUE, year = 2011, survey="acs1", cache_table = TRUE)
quartile.11.2 <- get_acs(geography = "congressional district", variables = "B19081_002",
geometry = TRUE, year = 2011, survey="acs1", cache_table = TRUE)
quartile.11.3 <- get_acs(geography = "congressional district", variables = "B19081_003",
geometry = TRUE, year = 2011, survey="acs1", cache_table = TRUE)
quartile.11.4 <- get_acs(geography = "congressional district", variables = "B19081_004",
geometry = TRUE, year = 2011, survey="acs1", cache_table = TRUE)
quartile.11.5 <- get_acs(geography = "congressional district", variables = "B19081_005",
geometry = TRUE, year = 2011, survey="acs1", cache_table = TRUE)
quartile.11.top5 <- get_acs(geography = "congressional district", variables = "B19081_006",
geometry = TRUE, year = 2011, survey="acs1", cache_table = TRUE)
#B02008_001
white.11 <- get_acs(geography = "congressional district", variables = "B02001_002",
geometry = TRUE, year = 2011, survey="acs1", cache_table = TRUE)
# black <- get_acs(geography = "congressional district", variables = "B02001_002",
#                  geometry = TRUE, year = 2011, survey="acs1", cache_table = TRUE)
total.11 <- get_acs(geography = "congressional district", variables = "B02001_001",
geometry = TRUE, year = 2011, survey="acs1", cache_table = TRUE)
white.12 <- get_acs(geography = "congressional district", variables = "B02001_002",
geometry = TRUE, year = 2012, survey="acs1", cache_table = TRUE)
total.12 <- get_acs(geography = "congressional district", variables = "B02001_001",
geometry = TRUE, year = 2012, survey="acs1", cache_table = TRUE)
white.13 <- get_acs(geography = "congressional district", variables = "B02001_002",
geometry = TRUE, year = 2013, survey="acs1", cache_table = TRUE)
total.13 <- get_acs(geography = "congressional district", variables = "B02001_001",
geometry = TRUE, year = 2013, survey="acs1", cache_table = TRUE)
# white.14 <- get_acs(geography = "congressional district", variables = "B02001_002",
#                     geometry = TRUE, year = 2014, survey="acs1", cache_table = TRUE)
#
# total.14 <- get_acs(geography = "congressional district", variables = "B02001_001",
#                     geometry = TRUE, year = 2014, survey="acs1", cache_table = TRUE)
white.15 <- get_acs(geography = "congressional district", variables = "B02001_002",
geometry = TRUE, year = 2015, survey="acs1", cache_table = TRUE)
total.15 <- get_acs(geography = "congressional district", variables = "B02001_001",
geometry = TRUE, year = 2015, survey="acs1", cache_table = TRUE)
white.16 <- get_acs(geography = "congressional district", variables = "B02001_002",
geometry = TRUE, year = 2016, survey="acs1", cache_table = TRUE)
total.16 <- get_acs(geography = "congressional district", variables = "B02001_001",
geometry = TRUE, year = 2016, survey="acs1", cache_table = TRUE)
white.17 <- get_acs(geography = "congressional district", variables = "B02001_002",
geometry = TRUE, year = 2017, survey="acs1", cache_table = TRUE)
total.17 <- get_acs(geography = "congressional district", variables = "B02001_001",
geometry = TRUE, year = 2017, survey="acs1", cache_table = TRUE)
white.18 <- get_acs(geography = "congressional district", variables = "B02001_002",
geometry = TRUE, year = 2018, survey="acs1", cache_table = TRUE)
total.18 <- get_acs(geography = "congressional district", variables = "B02001_001",
geometry = TRUE, year = 2018, survey="acs1", cache_table = TRUE)
white.19 <- get_acs(geography = "congressional district", variables = "B02001_002",
geometry = TRUE, year = 2019, survey="acs1", cache_table = TRUE)
total.19 <- get_acs(geography = "congressional district", variables = "B02001_001",
geometry = TRUE, year = 2019, survey="acs1", cache_table = TRUE)
#Project: Commonly Used Data
#Author: Josh Ryan
#Working Date: Summer 22
#Task: Get Census data for income and race, format data
#Related files:
library(foreign)
library(effects)
library(sciplot)
library(sandwich)
library(lmtest)
library(BMS)
library(rJava)
library(lattice)
library(plyr)
library(lme4)
library(gmodels)
library(MASS)
library(stringr)
library("XLConnect")
library(reshape2)
library(xlsx)
library(dplyr)
library(doBy)
library(Hmisc)
library(stargazer)
library(xtable)
library(dplyr)
library(xtable)
library(foreign)
library(dotwhisker)#https://cran.r-project.org/web/packages/dotwhisker/vignettes/dotwhisker-vignette.html
library(berryFunctions) #for the insert row function
library(ggplot2)
library(gridExtra)
library(wnominate)
library(tidyr)
library(wnominate)
library(oc)
library(haven)
library(tidycensus)
library(ggplot2)
library(tidyverse)
library(viridis)
#01_getcensusdata must be run before this file
#format income first, this is median CD income
income.11$cong<-112
income.11$year<-2011
income.12$cong<-112
income.12$year<-2012
income.13$cong<-113
income.13$year<-2013
#income.14$cong<-113
#income.14$year<-2014
income.15$cong<-114
income.15$year<-2015
income.16$cong<-114
income.16$year<-2016
income.17$cong<-115
income.17$year<-2017
income.18$cong<-115
income.18$year<-2018
income.19$cong<-116
income.19$year<-2019
median.income<-rbind(income.11, income.12,income.13,
#income.14
income.15, income.16, income.17,income.18,income.19)
median.income$state <- sub('.*,\\s*', '', median.income$NAME)
median.income$cd<-gsub("Congressional District ", "", median.income$NAME)
median.income$cd<-sub(" .*", "", median.income$cd)
median.income$cd <- gsub("\\(at", "1", median.income$cd)
median.income$state<-state.abb[match(median.income$state,state.name)]
median.income$panelid<-paste(median.income$state,median.income$cd, sep="")
table(median.income$cd)
table(median.income$panelid)
table(median.income$year)
#some extras due to delegates and residents
#scale by 2021 dollars--create constant dollars
median.income$estimate.adj[median.income$year==2011]<-median.income$estimate*1.207261725
median.income$estimate.adj[median.income$year==2012]<-median.income$estimate*1.182222222
median.income$estimate.adj[median.income$year==2013]<-median.income$estimate*1.164963504
median.income$estimate.adj[median.income$year==2014]<-median.income$estimate*1.145564169
median.income$estimate.adj[median.income$year==2015]<-median.income$estimate*1.143594153
median.income$estimate.adj[median.income$year==2016]<-median.income$estimate*1.129032258
median.income$estimate.adj[median.income$year==2017]<-median.income$estimate*1.105263158
median.income$estimate.adj[median.income$year==2018]<-median.income$estimate*1.078961601
median.income$estimate.adj[median.income$year==2019]<-median.income$estimate*1.059760956
#take average for a congress
avg.med.income<-aggregate(estimate.adj~panelid+cong,median.income, mean)
avg.med.income$avg.median.income<-avg.med.income$estimate.adj
avg.med.income$estimate.adj<-NULL
write.csv(avg.med.income, "C:/Users/Josh Ryan/Dropbox/Commonly Used Data/Census API Data/average_median_income.csv", row.names=FALSE)
#for income quartiles, first cbind for each year
quartile.11<-cbind(quartile.11.1, quartile.11.2, quartile.11.3, quartile.11.4, quartile.11.5, quartile.11.top5)
quartile.11$cong<-112
quartile.11$year<-2011
quartile.12<-cbind(quartile.12.1, quartile.12.2, quartile.12.3, quartile.12.4, quartile.12.5, quartile.12.top5)
quartile.12$cong<-112
quartile.12$year<-2012
quartile.13<-cbind(quartile.13.1, quartile.13.2, quartile.13.3, quartile.13.4, quartile.13.5, quartile.13.top5)
quartile.13$cong<-113
quartile.13$year<-2013
# quartile.14<-cbind(quartile.14.1, quartile.14.2, quartile.14.3, quartile.14.4, quartile.14.5, quartile.14.top5)
# quartile.14$cong<-113
#quartile.14$year<-2014
quartile.15<-cbind(quartile.15.1, quartile.15.2, quartile.15.3, quartile.15.4, quartile.15.5, quartile.15.top5)
quartile.15$cong<-114
quartile.15$year<-2015
quartile.16<-cbind(quartile.16.1, quartile.16.2, quartile.16.3, quartile.16.4, quartile.16.5, quartile.16.top5)
quartile.16$cong<-114
quartile.16$year<-2016
quartile.17<-cbind(quartile.17.1, quartile.17.2, quartile.17.3, quartile.17.4, quartile.17.5, quartile.17.top5)
quartile.17$cong<-115
quartile.17$year<-2017
quartile.18<-cbind(quartile.18.1, quartile.18.2, quartile.18.3, quartile.18.4, quartile.18.5, quartile.18.top5)
quartile.18$cong<-115
quartile.18$year<-2018
quartile.19<-cbind(quartile.19.1, quartile.19.2, quartile.19.3, quartile.19.4, quartile.19.5, quartile.19.top5)
quartile.19$cong<-116
quartile.19$year<-2019
#now row bind together
quartiles.all<-rbind(quartile.11, quartile.12, quartile.13,
# quartile.14,
quartile.15, quartile.16, quartile.17, quartile.18, quartile.19)
quartiles.all$quartile.1<-quartiles.all$estimate
quartiles.all$quartile.2<-quartiles.all$estimate.1
quartiles.all$quartile.3<-quartiles.all$estimate.2
quartiles.all$quartile.4<-quartiles.all$estimate.3
quartiles.all$quartile.5<-quartiles.all$estimate.4
quartiles.all$percentile.95<-quartiles.all$estimate.5
#identify districts
quartiles.all$state <- sub('.*,\\s*', '', quartiles.all$NAME)
quartiles.all$cd<-gsub("Congressional District ", "", quartiles.all$NAME)
quartiles.all$cd<-sub(" .*", "", quartiles.all$cd)
quartiles.all$cd <- gsub("\\(at", "1", quartiles.all$cd)
quartiles.all$state<-state.abb[match(quartiles.all$state,state.name)]
quartiles.all$panelid<-paste(quartiles.all$state,quartiles.all$cd, sep="")
table(quartiles.all$panelid)
#scale by 2021 dollars--create constant dollars
quartiles.all$quartile.1.adj[quartiles.all$year==2011]<-quartiles.all$quartile.1*1.207261725
quartiles.all$quartile.1.adj[quartiles.all$year==2012]<-quartiles.all$quartile.1*1.182222222
quartiles.all$quartile.1.adj[quartiles.all$year==2013]<-quartiles.all$quartile.1*1.164963504
quartiles.all$quartile.1.adj[quartiles.all$year==2014]<-quartiles.all$quartile.1*1.145564169
quartiles.all$quartile.1.adj[quartiles.all$year==2015]<-quartiles.all$quartile.1*1.143594153
quartiles.all$quartile.1.adj[quartiles.all$year==2016]<-quartiles.all$quartile.1*1.129032258
quartiles.all$quartile.1.adj[quartiles.all$year==2017]<-quartiles.all$quartile.1*1.105263158
quartiles.all$quartile.1.adj[quartiles.all$year==2018]<-quartiles.all$quartile.1*1.078961601
quartiles.all$quartile.1.adj[quartiles.all$year==2019]<-quartiles.all$quartile.1*1.059760956
quartiles.all$quartile.2.adj[quartiles.all$year==2011]<-quartiles.all$quartile.2*1.207261725
quartiles.all$quartile.2.adj[quartiles.all$year==2012]<-quartiles.all$quartile.2*1.182222222
quartiles.all$quartile.2.adj[quartiles.all$year==2013]<-quartiles.all$quartile.2*1.164963504
quartiles.all$quartile.2.adj[quartiles.all$year==2014]<-quartiles.all$quartile.2*1.145564169
quartiles.all$quartile.2.adj[quartiles.all$year==2015]<-quartiles.all$quartile.2*1.143594153
quartiles.all$quartile.2.adj[quartiles.all$year==2016]<-quartiles.all$quartile.2*1.129032258
quartiles.all$quartile.2.adj[quartiles.all$year==2017]<-quartiles.all$quartile.2*1.105263158
quartiles.all$quartile.2.adj[quartiles.all$year==2018]<-quartiles.all$quartile.2*1.078961601
quartiles.all$quartile.2.adj[quartiles.all$year==2019]<-quartiles.all$quartile.2*1.059760956
quartiles.all$quartile.3.adj[quartiles.all$year==2011]<-quartiles.all$quartile.3*1.207261725
quartiles.all$quartile.3.adj[quartiles.all$year==2012]<-quartiles.all$quartile.3*1.182222222
quartiles.all$quartile.3.adj[quartiles.all$year==2013]<-quartiles.all$quartile.3*1.164963504
quartiles.all$quartile.3.adj[quartiles.all$year==2014]<-quartiles.all$quartile.3*1.145564169
quartiles.all$quartile.3.adj[quartiles.all$year==2015]<-quartiles.all$quartile.3*1.143594153
quartiles.all$quartile.3.adj[quartiles.all$year==2016]<-quartiles.all$quartile.3*1.129032258
quartiles.all$quartile.3.adj[quartiles.all$year==2017]<-quartiles.all$quartile.3*1.105263158
quartiles.all$quartile.3.adj[quartiles.all$year==2018]<-quartiles.all$quartile.3*1.078961601
quartiles.all$quartile.3.adj[quartiles.all$year==2019]<-quartiles.all$quartile.3*1.059760956
quartiles.all$quartile.4.adj[quartiles.all$year==2011]<-quartiles.all$quartile.4*1.207261725
quartiles.all$quartile.4.adj[quartiles.all$year==2012]<-quartiles.all$quartile.4*1.182222222
quartiles.all$quartile.4.adj[quartiles.all$year==2013]<-quartiles.all$quartile.4*1.164963504
quartiles.all$quartile.4.adj[quartiles.all$year==2014]<-quartiles.all$quartile.4*1.145564169
quartiles.all$quartile.4.adj[quartiles.all$year==2015]<-quartiles.all$quartile.4*1.143594153
quartiles.all$quartile.4.adj[quartiles.all$year==2016]<-quartiles.all$quartile.4*1.129032258
quartiles.all$quartile.4.adj[quartiles.all$year==2017]<-quartiles.all$quartile.4*1.105263158
quartiles.all$quartile.4.adj[quartiles.all$year==2018]<-quartiles.all$quartile.4*1.078961601
quartiles.all$quartile.4.adj[quartiles.all$year==2019]<-quartiles.all$quartile.4*1.059760956
quartiles.all$quartile.5.adj[quartiles.all$year==2011]<-quartiles.all$quartile.5*1.207261725
quartiles.all$quartile.5.adj[quartiles.all$year==2012]<-quartiles.all$quartile.5*1.182222222
quartiles.all$quartile.5.adj[quartiles.all$year==2013]<-quartiles.all$quartile.5*1.164963504
quartiles.all$quartile.5.adj[quartiles.all$year==2014]<-quartiles.all$quartile.5*1.145564169
quartiles.all$quartile.5.adj[quartiles.all$year==2015]<-quartiles.all$quartile.5*1.143594153
quartiles.all$quartile.5.adj[quartiles.all$year==2016]<-quartiles.all$quartile.5*1.129032258
quartiles.all$quartile.5.adj[quartiles.all$year==2017]<-quartiles.all$quartile.5*1.105263158
quartiles.all$quartile.5.adj[quartiles.all$year==2018]<-quartiles.all$quartile.5*1.078961601
quartiles.all$quartile.5.adj[quartiles.all$year==2019]<-quartiles.all$quartile.5*1.059760956
quartiles.all$quartile.5.adj[quartiles.all$year==2011]<-quartiles.all$percentile.95*1.207261725
quartiles.all$quartile.5.adj[quartiles.all$year==2012]<-quartiles.all$percentile.95*1.182222222
quartiles.all$quartile.5.adj[quartiles.all$year==2013]<-quartiles.all$percentile.95*1.164963504
quartiles.all$quartile.5.adj[quartiles.all$year==2014]<-quartiles.all$percentile.95*1.145564169
quartiles.all$quartile.5.adj[quartiles.all$year==2015]<-quartiles.all$percentile.95*1.143594153
quartiles.all$quartile.5.adj[quartiles.all$year==2016]<-quartiles.all$percentile.95*1.129032258
quartiles.all$quartile.5.adj[quartiles.all$year==2017]<-quartiles.all$percentile.95*1.105263158
quartiles.all$quartile.5.adj[quartiles.all$year==2018]<-quartiles.all$percentile.95*1.078961601
quartiles.all$percentile.95.adj[quartiles.all$year==2019]<-quartiles.all$percentile.95*1.059760956
#now find averages by congress
quartile.by.cong.1<-aggregate(quartile.1.adj~panelid+cong,quartiles.all,mean)
quartile.by.cong.2<-aggregate(quartile.2.adj~panelid+cong,quartiles.all,mean)
quartile.by.cong.3<-aggregate(quartile.3.adj~panelid+cong,quartiles.all,mean)
quartile.by.cong.4<-aggregate(quartile.4.adj~panelid+cong,quartiles.all,mean)
quartile.by.cong.5<-aggregate(quartile.5.adj~panelid+cong,quartiles.all,mean)
quartile.by.cong.percentile.95<-aggregate(percentile.95.adj~panelid+cong,quartiles.all,mean)
quartiles.all<-merge(quartile.by.cong.1, quartile.by.cong.2, by=c("cong", "panelid"))
quartiles.all<-merge(quartiles.all, quartile.by.cong.3, by=c("cong", "panelid"))
quartiles.all<-merge(quartiles.all, quartile.by.cong.4, by=c("cong", "panelid"))
quartiles.all<-merge(quartiles.all, quartile.by.cong.5, by=c("cong", "panelid"))
quartiles.all<-merge(quartiles.all, quartile.by.cong.percentile.95, by=c("cong", "panelid"))
quartiles.all$diff.adj<-quartiles.all$quartile.5.adj-quartiles.all$quartile.1.adj
quartiles.all$diff_5_95.adj<-quartiles.all$percentile.95.adj-quartiles.all$quartile.1.adj
write.csv(quartiles.all, "C:/Users/Josh Ryan/Dropbox/Commonly Used Data/Census API Data/income_inequality_quartiles_v1.csv", row.names=FALSE))
write.csv(quartiles.all, "C:/Users/Josh Ryan/Dropbox/Commonly Used Data/Census API Data/income_inequality_quartiles_v1.csv", row.names=FALSE)
race.11<-cbind(white.11, total.11)
race.12<-cbind(white.12, total.12)
race.13<-cbind(white.13, total.13)
#race.14<-cbind(white.14, total.14)
race.15<-cbind(white.15, total.15)
race.16<-cbind(white.16, total.16)
race.17<-cbind(white.17, total.17)
race.18<-cbind(white.18, total.18)
race.19<-cbind(white.19, total.19)
race.11$cong<-112
race.11$year<-2011
race.12$cong<-112
race.12$year<-2012
race.13$cong<-113
race.13$year<-2013
#race.14$cong<-113
#race.14$year<-2014
race.15$cong<-114
race.15$year<-2015
race.16$cong<-114
race.16$year<-2016
race.17$cong<-115
race.17$year<-2017
race.18$cong<-115
race.18$year<-2018
race.19$cong<-116
race.19$year<-2019
race<-rbind(race.11, race.12,race.13,
#race.14
race.15, race.16, race.17,race.18,race.19)
race$state <- sub('.*,\\s*', '', race$NAME)
race$cd<-gsub("Congressional District ", "", race$NAME)
race$cd<-sub(" .*", "", race$cd)
race$cd <- gsub("\\(at", "1", race$cd)
race$state<-state.abb[match(race$state,state.name)]
race$panelid<-paste(race$state,race$cd, sep="")
table(race$cd)
table(race$panelid)
table(race$year)
race$per.white<-race$estimate/race$estimate.1
summary(race$per.white)
race$per.nonwhite<-1-race$per.white
white.by.cong<-aggregate(per.white~panelid+cong, race, mean)
nonwhite.by.cong<-aggregate(per.nonwhite~panelid+cong, race, mean)
race.by.cong<-merge(white.by.cong, nonwhite.by.cong, by=c("panelid", "cong"))
write.csv(race.by.cong, "C:/Users/Josh Ryan/Dropbox/Commonly Used Data/Census API Data/race_by_cong_district_v1.csv", row.names=FALSE)
#Project: Budget Control Act
#Author: Josh Ryan
#Working Date: Winter 22
#Task: Use Imai, Kim, Wang PanelMatch process used to analyze data
#Related files: loads saved dataset prior to stata processing because saving as. dta messes some things up
library(foreign)
library(effects)
library(sciplot)
library(sandwich)
library(lmtest)
library(BMS)
library(rJava)
library(lattice)
library(plyr)
library(lme4)
library(gmodels)
library(MASS)
library(stringr)
library("XLConnect")
library(reshape2)
library(xlsx)
library(dplyr)
library(doBy)
library(Hmisc)
library(stargazer)
library(xtable)
library(dplyr)
library(xtable)
library(foreign)
library(dotwhisker)#https://cran.r-project.org/web/packages/dotwhisker/vignettes/dotwhisker-vignette.html
library(berryFunctions) #for the insert row function
library(ggplot2)
library(gridExtra)
library(wnominate)
library(tidyr)
library(wnominate)
library(oc)
library(haven)
library(PanelMatch)
dat<-read.csv("./datasets/saved_data/district-level-housewelection_othervars_v1_112822.csv")
getwd()
25*12
